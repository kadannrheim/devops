# Блок заданий по kubernetes



# Команды управления kubernetes через kubectl

`kubectl create -f sample.yaml` -создать деплоймент
`kubectl delete deployment busybox` -удалить деплоймент
`kubectl get pods --all-namespaces` -вывести все Pods из всех Namespaces
`kubectl scale deployment <deployment-name> --replicas=3` -изменить количество реплик
`kubectl describe <тип-ресурса> <имя-ресурса>` -для получения подробной информации о статусе ресурса
`kubectl describe nodes` -пример использования describe или `kubectl describe deployment sample-site`
`kubectl get nodes -o wide` -какие ноды запущены 
`kubectl get svc` -вывести созданные сервисы (нужны для сетевого доступа к подам)
`kubectl get deployments -l app=sample-site` -вывести все развёртывания с метками (labels) sample-site
`kubectl exec deploy/toolkit -ti -- /bin/bash` -зайти в под

# Статусы подов

`Pending` - pod принят k8s, но еще не запущен.
`Running` - pod уже привязан к ноде, и все его контейнеры были созданы. И как минимум один из них запущен, либо в процессе запуска/перезапуска
`Succeeded` - все контейнеры пода успешно завершили свою работу. Более pod уже не будет запускаться(обычно это Job)
`Failed` - все контейнеры пода завершили работу, но как минимум один с ошибкой. То есть он либо завершился с ненулевым статусом, либо был убит системой
`Unknown` - состояние пода неизвестно, вероятно из-за отсутствия коммуникации с рабочей нодой
`CrashLoopBackOff` - процесс внутри пода завершается с ошибкой
`ImagePullBackOff` - не найден образ контейнера, либо нет доступа к образу

# Статусы контейнеров

`Waiting` - если контейнер не находится в Running/Terminated, значит он Waiting =) Например, он находится в подготовительном процессе для запуска, скачивает образ контейнера
`Running` - Означает что все успешно запустилось
`Terminated` - Успешно или не очень завершилась работа контейнера. Более подробно вы можете посмотреть с помощью команды kubectl describe pod

# Пробы подов

`livenessProbe` - проверка, что контейнер еще жив, то есть не подвис и выполняет свои функции. Эта проверка выполняется с указанным интервалом после старта контейнера

`readinessProbe` - определение момента готовности контейнера принимать трафик(нагрузку). Эта проверка особенно полезна для приложений, запуск которых может занимать значительное время, в том время как уже сам контейнер давно запущен. Если не установить такую проверку, то для кубера он будет выглядеть как готовый контейнер, и он начнет отправлять на него трафик, хотя по факту приложение еще запускается.

`startupProbe` - проверяет, запущено ли приложение внутри контейнера. Это может быть использовано для настройки проверок livenessProbe медленно запускающихся контейнеров, чтобы избежать их завершения до того, как они полностью заработают. Эта проверка вызывается только в начале работы контейнера, в отличие от двух остальных, которые делают проверку периодически

# Интервал портов по умолчанию разрешенном в k8s для NodePort.
`30000-32767`